{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create WishList</title>
    <link rel="stylesheet" href="{% static 'WishStack/css/Main.css' %}">
    <style>
      body {
        background-image: url("{% static 'WishStack/images/Gift.png' %}");
      }
    </style>
    <style>
        /* Style for the modal */
        .modal {
            display: none; /* Hidden by default */
            position: absolute; /* Position it relative to the parent container */
            background-color: #fefefe; /* Modal background color */
            border: 1px solid #888; /* Modal border */
            padding: 20px; /* Modal padding */
            z-index: 1; /* Ensure modal stays on top */
        }
    
        /* Style for the close button */
        .close {
            color: #aaa; /* Close button color */
            float: right; /* Float the button to the right */
            font-size: 28px; /* Close button font size */
            font-weight: bold; /* Close button font weight */
        }
    
        /* Style for the modal content */
        .modal-content {
            display: flex; /* Display modal content as a flexbox */
            flex-direction: column; /* Arrange modal content in a column */
        }
    
        /* Style for the input field */
        #shareUrlInput {
            margin-bottom: 10px; /* Add some space below the input field */
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <nav class="navbar">
            <ul class="navbar-list">
                <li style="text-align: center;"><a>Create your WishList</a></li>
            </ul>
            <div class="filter-dropdown">
                Filter
                <div class="filter-dropdown-content">
                    <button id="highToLowBtn">High to Low</button>
                    <button id="lowToHighBtn">Low to High</button>
                </div>
            </div>
            <button class="share-button" id="shareButton">Share</button>
            <button class="logout-button" onclick="window.location.href='{% url 'logout' %}'">Logout</button>
        </nav>
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <p>Share this URL:</p>
                <input type="text" id="shareUrlInput" readonly>
                <button id="copyButton">Copy</button>
            </div>
        </div>
        <div style="text-align: center; margin-top: 20px;">
            <button class="amazon-button" onclick="window.location.href='{% url 'scrape_flipkart' %}'" data-api-url="{% url 'start_wishing' %}?wishlistName={{ wishlist_name }}">Flipkart</button>
            <button class="amazon-button" onclick="window.location.href='{% url 'scrape_flipkart1' %}'" data-api-url="{% url 'start_wishing' %}?wishlistName={{ wishlist_name }}">Flipkart Clothing</button>
        </div>
    </div>
    <script src="WishStack/js/Main.js"></script>
    <script>
    document.getElementById("shareButton").addEventListener("click", function() {
        // Get the current URL
        var currentUrl = window.location.href;
        
        // Assuming you have a variable containing the wishlist ID or name
        var wishlistId = "{{ wishlist_id }}"; // Replace "{{ wishlist_id }}" with your actual wishlist ID
        
        // Construct the share URL
        var shareUrl = currentUrl + "?wishlist=" + wishlistId;
        
        // Display the modal below the share button
        var modal = document.getElementById("myModal");
        var shareButtonRect = document.getElementById("shareButton").getBoundingClientRect();
        modal.style.top = (shareButtonRect.bottom + window.pageYOffset) + "px";
        modal.style.left = shareButtonRect.left + "px";
        modal.style.display = "block";

        // Populate and copy the URL when "Copy" button is clicked
        var shareUrlInput = document.getElementById("shareUrlInput");
        shareUrlInput.value = shareUrl;
        
        // Remove any existing event listener to avoid duplication
        var copyButton = document.getElementById("copyButton");
        copyButton.removeEventListener("click", copyUrlToClipboard);
        
        // Add event listener to copy URL to clipboard
        copyButton.addEventListener("click", copyUrlToClipboard);

        // Close the modal when the close button is clicked
        document.getElementsByClassName("close")[0].addEventListener("click", function() {
            modal.style.display = "none";
        });
    });

    // Function to copy URL to clipboard
    function copyUrlToClipboard() {
        var shareUrlInput = document.getElementById("shareUrlInput");
        shareUrlInput.select();
        document.execCommand("copy");
        alert("URL copied to clipboard");
    }
</script>

    
    
</body>
</html>
